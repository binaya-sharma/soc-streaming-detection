FROM python:3.12-slim
WORKDIR /app

# Use the requirements file you really intend (adjust path if needed)
COPY src/ingestor/requirements.txt /tmp/requirements.txt

# Defensive: removes the wrong 'kafka' pkg if present; then install correct deps
RUN pip uninstall -y kafka || true \
 && pip install --no-cache-dir -r /tmp/requirements.txt

# Copy producer code
COPY src/ingest/ /app/

CMD ["python", "producer.py"]